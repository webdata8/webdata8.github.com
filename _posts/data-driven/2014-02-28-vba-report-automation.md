---
layout: post
title: 结合VBA的Excel数据分析来思考网站数据报表中的自动化
description:
heading: 结合VBA的Excel数据分析来思考网站数据报表中的自动化
category: data-driven
publish: true
published: true
datePublished: 2014-02-28T00:00:00.000Z
dateModified:
date: 2014-02-28
---

众所周知，数据分析有很多知名的软件，而目前都在说大数据分析，那么对成千上万数据提取或者批量定期的报表更新，如果没法自动化程序来运行，那该如何是好呢？但不管网站的数据量 是多是少，关键还是取决于创建一个如何利用现有的工具简化流程，提高效率的分析思路。

先说一个和VBA有关的报表任务：每周，数据分析师都要从Google Analytics打开报表，导航至流量，转化等报表，然后选中指标日期维度，然后下载Excel文件。之后，打开报表，将数字复制到Excel报表里面去，粘贴复制复制粘贴，来来回回之后，数据透视表后，再做几张趋势图，好几个tab好几张chart。然后打开邮件，写上本周数字多少，转化多少，与之前一周项目上升百分之几，与去年同比下降百分之几。做完之后还要设计颜色，标注重点。前前后后花费了N多小时。

事实上，我们可以先简化为这么几步：

>1.运行网站分析软件报表
2.下载源数据，提取源数据
3.添加，整理并检验Excel中的数据
4.做出数据分析图和指标监控情况
5.整理到邮件里面，然后发送

然后我们来看看每个步骤是否可以优化，精简工作量。

>第一步，我们可以将需要分析的指标维度做成自定义报表的格式，不管是GA还是Sitecatalyst都提供了Dashboard，Bookmark，Shortcut等形式的报表，不用每次再去拖拉。
第二步，我们可以在已经设置好的报表里面设计成邮件自定发送，自动发送到你的邮件，分析工具一定有这样的功能。只要从邮件下载文件或直接打开即可。
第三步，很手工化的一部分，将之前得到的源数据整理到周报里面，似乎没有捷径。
第四步，通过Excel函数，数据透视表刷新，图表建立，似乎又要手工了，而事实上，通过VBA是可以自动帮你刷新每个tab中的图表的。
第五步，将本周亮点写成邮件的形式发送，比如本周流量50,000，同比增加10%，环比增加30%。这个也会有点麻烦，如果邮件系统是Outlook的话可以用VBA，如果不是可以先弄到Word在更新。

因此，通过简单的流程设计和梳理，加上VBA程序，似乎也节省了不少时间。但是不是还有可挖掘的呢？再说一个例子，有一个网站叫Authority Labs，是英文站点专门跟踪搜索引擎关键词排名的，每周都要计算每个域名的Top 10个数，一个一个数是不可能，通过CSV文件倒出来再去些countif函数也麻烦，那么是不是可以用VBA模拟登陆之后，然后自动下载文件打开并计算然后返回所要的值？可以的，VBA有很多模拟浏览器IE的组件，可以做出很有意思的程序，有机会再谈这个。所以，我们就可以再第一、二、三步做文章了，模拟登陆后，再通过VBA或者录制宏可以将有规律的数字和公式自动地更新到所要的报表Excel里面。

这么一来，就可以实现全流程程序化了，这下就可以松一口了，不用花那么多时间消耗在针对周报月报的监控，可以投入更多的精力去分析具体项目的数据分析了。在这里，要提下《<a href="http://blog.sina.com.cn/s/blog_49f78a4b0102e2kt.html" target="_blank">谁说菜鸟不会数据分析-工具篇</a>》中的第四章节，讲述了一个通过VBA提取SQL然后更新到Excel和PPT里面的实例，很精彩。

大概还有这么几种可以自动化的数据分析需求：

>1.设置邮件警报：如流量较前一周+-20%（很多网站分析工具都可以自定义设计Alert）
2.定期发送源数据文件：如收到每月的CSV，PDF文件
3.通过脚本运行下载所要的自定义数据：比如Linux代码得到服务器日志，SQL代码得到内部数据库数据
4.通过开放的API获取所要的数据，以此来做成报表系统或者工具。（事实上，对于GA，谷歌已经提供了GA API，只要利用API储存在内部数据库里面，就不愁做不出数据报表了，有条件的网站还可以做自己的Back Office或者BI系统，这个是后话了）

写在文末：一定会有很多人问，不用VBA可以做到上面提到网站数据报表的自动化例子吗？肯定可以的，事实上，其实的程序语言甚至任何的都可以处理数据自动化，还是那句话，<a href="/data-driven/first-post/">工具只是工具，只要把分析的流程列清楚</a>，一切自然就水到渠成了。

注：所有文章及图片版权归网站数据吧（WebData8.com）所有。转载请注明出处“<a href="/">Webdata8网站分析</a>”。
